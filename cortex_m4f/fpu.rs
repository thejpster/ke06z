//! # FPU support for the Cortex-M4F

// ****************************************************************************
//
// Imports
//
// ****************************************************************************

use super::registers;
use cortex_m;

// ****************************************************************************
//
// Public Types
//
// ****************************************************************************

// None

// ****************************************************************************
//
// Public Data
//
// ****************************************************************************

// None

// ****************************************************************************
//
// Private Types
//
// ****************************************************************************

// None

// ****************************************************************************
//
// Private Data
//
// ****************************************************************************

// None

// ****************************************************************************
//
// Public Functions
//
// ****************************************************************************

pub fn init() {
    // Enable full access to the FPU
    let mut t = cortex_m::peripheral::scb().cpacr.read();
    unsafe {
        t &= !(registers::NVIC_CPAC_CP11_M as u32 | registers::NVIC_CPAC_CP10_M as u32);
        t |= registers::NVIC_CPAC_CP11_FULL as u32 | registers::NVIC_CPAC_CP10_FULL as u32;
        cortex_m::peripheral::scb_mut().cpacr.write(t);
    }
}

// ****************************************************************************
//
// Private Functions
//
// ****************************************************************************

// None

// ****************************************************************************
//
// End Of File
//
// ****************************************************************************
